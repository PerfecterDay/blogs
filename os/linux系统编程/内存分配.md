## 内存分配
{docsify-updated}

- [内存分配](#内存分配)

<center><img src="pics/process.jpg" width="30%"></center>

进程可以通过增加堆的大小来分配内存，所谓堆是一段长度可变的连续虚拟内存，始于进程的未初始化数据段末尾，随着内存的分配和释放而增减。通常将堆的当前内存边界称为“program break”。

+ `void	*brk(const void *end_data_segment)`  
  系统调用 brk() 会将 program break 设置为参数 end_data_segment 所指定的位置。由于虚拟内存以页为单位进行分配，end_data_segment 实际会四舍五入到下一个内存页的边界处（内存对齐）。
  当试图将 program break 设置为一个低于其初始值(即低于&end)的位置时，有可能会导 致无法预知的行为，例如，当程序试图访问的数据位于初始化或未初始化数据段中当前尚不 存在的部分时，就会引发分段内存访问错误(segmentation fault)(SIGSEGV 信号，在 20.2 节 描述)。program break 可以设定的精确上限取决于一系列因素，这包括进程中对数据段大小的 资源限制(36.3 节中描述的 RLIMIT_DATA)，以及内存映射、共享内存段、共享库的位置。
