## 计算机组成原理
{docsify-updated}

- [计算机组成原理](#计算机组成原理)
  - [概论](#概论)
  - [系统总线](#系统总线)
    - [总线分类](#总线分类)
    - [总线标准](#总线标准)
    - [总线结构](#总线结构)
    - [总线控制](#总线控制)


### 概论

1. 计算机组成与计算机体系结构的区别？
   计算机体系结构是指那些能够被程序员缩减到的计算机系统的属性，及概念性的结构和功能特性，通常是指用机器语言编程的程序员所看到的传统机器的属性，包括指令集、数据类型、存储器寻址技术、I/O 机理等大都属于抽象的属性。
   计算机组成是指如何实现计算机体系结构所体现的属性，它包含了许多对程序员来说是透明的硬件细节。例如指令系集体现了机器的属性，这是计算机体系结构的问题，但是指令的实现属于计算机组成问题。当两台机器指令系统相同时，只能认为他们具有相同的体系结构，至于两台机器如何实现指令的，则可能完全不同。

2. 计算机硬件的主要技术指标
   1. 机器字长：指CPU一次能处理的数据的位数，通常与CPU寄存器位数有关。
   2. 存储容量：包括主存（内存）和辅存（硬盘）容量。MAR（Memory Address Register）是存储器地址寄存器，地址总线上传过来的地址暂存在该寄存器中，它的长度可以反映存储单元的个数；MDR（Memeory Data Register）是存储数据寄存器，反映了存储单元中存储字的长度。
   3. 运算速度：普遍采用单位时间内执行指令的平均条数来衡量。

3. 计算机的基本组成

   1. 运算器，用来完成算术逻辑运算，并用寄存器暂存运算结果
   2. 控制器，控制、指挥程序和数据的输入、运行以及处理运算结果
   3. 存储器（内存），用来存放数据和程序
   4. IO（输入输出设备），鼠标、键盘、显示器、打印机等。

   运算器和控制器一般都做在CPU芯片内，CPU和主存又合称为主机。

### 系统总线

计算机系统的五大部件之间互连的方式有两种：

1. 各个部件之间使用单独的连线，称为分散连接
2. 将各个部件连到一组公共信息传输线上，称为总线连接

现代计算机系统一般都采用总线连接的方式。

#### 总线分类

1. 片内总线

   是指芯片内部的总线，如在 CPU 芯片内部，寄存器与寄存器之间、寄存器与算逻单元 ALU 之间都由片内总线连接。

2. 系统总线

   是指 CPU、内存、IO设备各大部件之间的信息传输线，由于这些部件通常都安装在主板上，故又称为板级总线。系统总线又可分为三类：数据总线、地址总线和控制总线。

   1. 数据总线

      数据总线用来传输各功能部件之间的数据信息，它是双向传输总线。数据总线的位数称为数据总线宽度，它是衡量系统性能的重要参数。如果数据总线宽度为8位，指令字长为16位，那么CPU在取指阶段必须两次访问主存。

   2. 地址总线

      地址总线主要用来指出数据总线上的源数据或目的数据在主存单元的地址或I/O设备的地址。地址总线上的地址代码是用来指明CPU欲访问的存储单元或I/O 设备的端口的地址，由CPU输出，单向传输。地址总线的宽度一般与MAR寄存器的宽度一致。

   3. 控制总线

      由于数据总线、地址总线都是被挂在总线上的所有部件共享的，如何使各个部件能在不同时刻占有总线使用权，需要依靠控制总线来完成，因此，控制总线是用来发出各种控制信号的传输线。通常对任一控制线而言，是单向传输的。例如，存储器读/写命令或者I/O设备的读/写命令都是由CPU发出的。但是对CPU或控制总线总体来说，是双向的，控制信号既有输入又有输出。常见的控制信号有：

      + 时钟：同步各种操作
      + 复位：初始化所有部件
      + 总线请求：表示某部件需要获得总线使用权
      + 总线允许：表示允许某部件的的总线请求，使得该部件获得总线使用权
      + 中断请求：表示某部件提出中断请求
      + 中断响应：表示中断请求已被接收
      + 存储器读/写：将数据总线数据写入到地址总线指定的内存地址单元或将存储器某地址单元数据读到数据总线上
      + I/O读写
      + 传输响应：表示数据已被接收，或将数据送至数据总线上

   4. 通信总线

      这类总线用于在计算机系统之间或计算机与其他系统设备之间的通信。如串口线、网线等。

#### 总线标准

总线标准可视为系统与各个模块、模块与模块之间的一个互连的标准界面。界面对它两端的模块都是透明的，即界面任一方只需要根据总线标准的要求完成自身一方接口的功能要求，而无需了解对方接口与总线的连接要求。目前流行的总线标准有以下几种：

1. ISA总线
2. EISA总线
3. VESA（VL-BUS）总线、
4. PCI总线
5. AGP总线
6. RS-232总线
7. USB总线

#### 总线结构

1. 单总线结构

   CPU、主存和IO设备都挂在一组总线上，允许IO之间或IO与主存之间交换信息。单总线结构不允许两个以上的部件在同一时刻向总线传输信息，极易称为系统的瓶颈。

2. 多总线结构
   <center><img src="pics/pci-bus.png" alt=""></center>

由于CPU核心频率的提升，导致内存跟不上CPU的速度，于是产生了与内存频率一致的系统总线，而CPU采用倍频的方式与系统总线进行通信。接着随着图形化的操作系统普及，特别是3D游戏和多媒体的发展，使得图形芯片需要跟CPU和内存之间大量交换数据，慢速的I/O总线已经无法满足图形设备的巨大需求。为了协调CPU、内存和高速的图形设备，人们专门设计了一个高速的北桥芯片，以便它们之间能够高速地交换数据。

由于北桥运行的速度非常高，所有相对低速的设备如果全都直接连接在北桥上，北桥既须处理高速设备，又须处理低速设备，设计就会十分复杂。于是人们又设计了专门处理低速设备的南桥（Southbridge）芯片，磁盘、USB、键盘、鼠标等设备都连接在南桥上，由南桥将它们汇总后连接到北桥上。

#### 总线控制

1. 总线仲裁逻辑
2. 总线通信控制